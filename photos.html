<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Photos</title>
  <link rel="stylesheet" href="styles.css?v=7" />
</head>
<body>

<main class="container">

  <div class="logo-wrap">
    <img src="Delcocup logo.png" alt="Delco Cup Logo" class="logo">
  </div>

  <h1>Photos</h1>

  <!-- Upload / View Buttons -->
  <section class="card">
    <h2>Delco Cup Photos</h2>
    <p class="small">Upload a photo or view the full gallery.</p>

    <div class="button-row">
      <a class="btn"
         target="_blank"
         rel="noopener"
         href="https://www.dropbox.com/request/4l9paOEDZwa7gl8U2I31">
        Upload Photo
      </a>

      <a class="btn secondary"
         target="_blank"
         rel="noopener"
         href="https://www.dropbox.com/scl/fo/b0hvhi5od49qil9c4e76p/AAsV8bh1eYgjJ2p1feFLmkg?rlkey=zuesmdykiy1dpfz2yrr5jm2gh&dl=0">
        View Gallery
      </a>
    </div>
  </section>

  <!-- LIVE GALLERY -->
  <section class="card">
    <div class="live-head">
      <h2>Live Gallery</h2>
      <span class="pill" id="statusText">Loadingâ€¦</span>
    </div>

    <div id="photo-grid" class="photo-grid"></div>
  </section>

</main>

<nav class="bottom-nav">
  <div class="nav-inner">
    <a class="nav-link" href="index.html">Welcome</a>
    <a class="nav-link" href="tee-times.html">Tee Times</a>
    <a class="nav-link" href="rooms.html">Rooms</a>
    <a class="nav-link active" href="photos.html">Photos</a>
  </div>
</nav>

<script>
const API = "https://morning-pine-c289.hz7rv6p2c8.workers.dev";

const grid = document.getElementById("photo-grid");
const statusText = document.getElementById("statusText");

async function loadPhotos() {
  try {
    const res = await fetch(API + "/list", { cache: "no-store" });
    const data = await res.json();

    if (!data.photos || data.photos.length === 0) {
      statusText.textContent = "No photos yet.";
      return;
    }

    statusText.textContent = data.photos.length + " items";

    data.photos.forEach(item => {
      const img = document.createElement("img");
      img.src = item.thumb;
      img.alt = item.name;
      img.onclick = () => window.open(item.file, "_blank");
      grid.appendChild(img);
    });

  } catch (e) {
    statusText.textContent = "Error loading photos";
    console.error(e);
  }
}

loadPhotos();
</script>

</body>
</html>
